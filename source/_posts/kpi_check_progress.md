title: KPI Check Progress
date: 2018/10/10
categories:
- Data Analysis
tags:
- KPI Check
---


## 1. 训练数据预处理 ##

首先过滤不合法的数据，若NAN>2%则该天数据不合法，若不合法的天数大于或等于3，则认为该7天周期的数据无法用于训练

训练数据中（要做阈值选取）不想有异常。进一步去除异常点。


### LOF ###


### 滤波 ###


## 2. 周期性检测 ##

利用自相关函数来进行判断

1. 将N天的数据拼接？？？
2. ？？？


## 3. 异常检测 ##

处理的对象是什么？计算的指标是什么？训练获取的是什么？检测时怎么做？


### 3.1. 周期性数据 ###

#### [点对点] ####

|||
|---|---|
|**对象**|各周期同一时刻的数据点|
|**处理法**|确定（两个？）固定的阈值，在此范围外的点为异常。|
|**核心思想**|周期性数据，不同天同一时刻的数据点，取值应该相差不大。|

- 直接统计**同一时刻数据点原始数据**。
- 训练：根据训练数据的均值和方差，计算K*sigma阈值。
  - 如果sigma是0，就按均值的10%来设置阈值。
- 检测：检测数据，若在阈值之外，则认为是异常。
  - 若异常点连续出现，则认为检出异常，否则进行抑制。


#### [FFT] ####

|||
|---|---|
|**对象**|各周期同一时刻的数据点及其前几个点，作为时间窗|
|**处理法**|同时刻时间窗做FFT，互相对比统计分布。|
|**核心思想**|周期性数据，不同天同一时刻（时间窗）的数据点，在频域的统计分布上应该相差不大。|

- 同一时刻的数据点及其前几个点作为**时间窗**，做FFT。
- 训练：？
- 检测：使用KS检验对训练数据的频域分布和检测数据的频域分布进行对比，若两者来自同一分布的程度大，则认为是正常，否则为异常。


#### [最小值] ####

对象每个周期的最小值，向下偏差一点作为阈值


### 3.2. 非周期性数据 ###

#### [大毛刺] ####

|||
|---|---|
|**对象**|所有数据点|
|**处理法**|确定（两个？）固定的阈值，在此范围外的点为异常。|
|**核心思想**|数据变化应较为平缓。|

- 将**原始数据**与**滤波后数据**，相减并取绝对值。
- 训练：根据训练数据的残余信号的均值和方差，计算$\mu \pm k \times \sigma$阈值。
- 检测：检测数据的残余信号，若在阈值之外，则认为是异常。
  - 多种滤波的结果投票，确定最终检出异常。
  - 若好几个周期都在某个时刻出现异常，则认为是系统的正常波动，对该时刻的检出异常进行抑制。


#### [动态阈值] ####

|||
|---|---|
|**对象**|所有数据点|
|**处理法**|确定（两个？）固定的阈值，在此范围外的点为异常。|
|**核心思想**|各数据点间应该相差不大。|

- 直接统计**原始数据**（区别于大毛刺检测中，存在滤波平滑处理）。
- 训练：根据训练数据的均值和方差，计算K*sigma阈值。
- 检测：检测数据，若在阈值之外，则认为是异常。


### 3.3. 异常点检测方法总结 ###

从上文可以看出，在KpiCheck中，对于异常点检测，主要使用的方法就是**K-sigma准则取阈值**。

此外，还有离群点检测方法**LOF**，被用于了训练数据预处理。

