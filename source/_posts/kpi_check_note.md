title: KPI Check Note
date: 2018/09/30
categories:
- Data Analysis
tags:
- KPI Check
---


## 依据 ##

- 当前曲线变化趋势与baseline应该相似
  - 周期性
  - 同质性
- 当前曲线变化趋势应该较平缓
  - 平滑性

---

## 毛刺检测 ##

### [滤波 + k-sigma准则] ###

曲线可以小幅度震荡。（高频低通）滤波后曲线与真实曲线的差值，在k-sigma以外的点为异常。

**滤波：**

- 中值滤波 Median Filter
  - 某点的值为该点周围一个窗口的中值，迭代滑动窗口。
- 滑动平均 Moving Average
  - 某点的值为该点前面一个窗口的平均值，迭代滑动窗口。
- 指数平滑 Exponential Smoothing
  - 一次指数平滑：适用于趋势无明显变化的时间序列<img src="exponential_smoothing.svg" width=600 />
  - 二次指数平滑：适用于线性趋势的时间序列
- 卡尔曼滤波 Kalman Filter

**k-sigma准则，通过统计理论检测异常点：**

- 3-σ：在正态分布中，数值分布在(μ—3σ,μ+3σ)中的概率约为0.9974。μ为均值、σ为标准差。

---

## 周期性数据横向对比-异常点检测 ##

### [聚类] ###

- DBSCAN，通过聚类检测异常点
  - 检测“邻域半径内的点个数”（即密度）。对满足密度要求的核心点，其邻域半径内所有点为新核心点，递归拓展“邻域-核心点”。

### [离群点检测] ###

- 局部异常因子 Local Outlier Factor, LOF
  - [算法介绍](https://blog.csdn.net/bbbeoy/article/details/80301211)
  - 在LOF之前的异常检测算法大多是基于统计方法、或借用聚类算法。但是，基于统计的异常检测算法通常需要假设数据服从特定的概率分布，这个假设往往是不成立的。而聚类的方法通常只能给出0/1判断（即是否为异常点），不能量化每个数据点的异常程度。相比较而言，基于密度的LOF算法要更简单、直观。它不需要对数据的分布做太多要求，还能量化每个数据点的异常程度。

### [FFT提取频域特征 + KS检验] ###

- KS检验 Kolmogorov-Smirnov Test
  - 基于CDF检验一个观测是否符合某一分布，或两个观测是否符合同一分布。

---

## 参数选择 ##

- 网格搜索 Grid Search
  - 遍历
- 模拟退火 Simulated Annealing
  - 若移动后得到更优解，则总是接受该移动；若移动后的解比当前解要差，则以一定的概率接受移动，而这个概率随着时间（迭代次数）推移而逐渐降低。初始时设置一个初始温度T和降温速度r，降温到一定程度则停止迭代。
  - 具体实现时，一定概率接受体现为：比较random(0,1)与计算出来的（接受移动）概率值。
  - 对比贪心策略：若移动后得到更优解，则总是接受该移动；否则，不移动。模拟退火能够一定程度上避免局部最优解困局。
